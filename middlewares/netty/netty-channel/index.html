<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Netty五大组件之Channel | 蚂蚁背大象</title><meta property="og:title" content="Netty五大组件之Channel"><meta property="og:description" content="Netty版本：4.1.72.Final
 1. Channel概述 1.1 Channel介绍 Channel 一种连接到网络套接字或能够进行读、写、连接和绑定等I/O操作的组件。有如下特点：
 所有的I/O操作都是异步 Channel是分层的 向下转换以访问特定传输的操作 释放资源  看一下继承关系：
上图可以看出来可以从两个纬度来划分：
  服务端还是客户端
比如：NioSocketChannel和EpollSocketChannel用于客户端， NioServerSocketChannel和EpollServerSocketChannel用于服务端
  Nio实现还是Epoll实现
NioSocketChannel，NioServerSocketChannel是NIO实现， EpollSocketChannel和EpollServerSocketChannel是Epoll实现
   Tips: Epoll实现参照 https://netty.io/wiki/native-transports.html
  NioSocketChannel(EpollSocketChannel)：代表异步的客户端 TCP Socket 连接 NioServerSocketChannel（EpollServerSocketChannel）：异步的服务器端 TCP Socket 连接 NioDatagramChannel：异步的 UDP 连接 NioSctpChannel：异步的客户端 Sctp 连接 NioSctpServerChannel：异步的 Sctp 服务器端连接 OioSocketChannel（OioSocketChannel）：同步的客户端 TCP Socket 连接 OioServerSocketChannel(Deprecated)：同步的服务器端 TCP Socket 连接 OioDatagramChannel(Deprecated)：同步的 UDP 连接 OioSctpChannel(Deprecated)：同步的 Sctp 服务器端连接 OioSctpServerChannel(Deprecated)：同步的客户端 TCP Socket 连接   Tips: 同步在源码中都已经标记为@Deprecated"><meta property="og:type" content="article"><meta property="og:url" content="/middlewares/netty/netty-channel/"><meta property="article:section" content="middlewares"><meta property="article:published_time" content="2022-01-16T00:00:00+00:00"><meta property="article:modified_time" content="2022-01-16T23:30:55+08:00"><meta property="og:site_name" content="蚂蚁背大象"><meta itemprop=name content="Netty五大组件之Channel"><meta itemprop=description content="Netty版本：4.1.72.Final
 1. Channel概述 1.1 Channel介绍 Channel 一种连接到网络套接字或能够进行读、写、连接和绑定等I/O操作的组件。有如下特点：
 所有的I/O操作都是异步 Channel是分层的 向下转换以访问特定传输的操作 释放资源  看一下继承关系：
上图可以看出来可以从两个纬度来划分：
  服务端还是客户端
比如：NioSocketChannel和EpollSocketChannel用于客户端， NioServerSocketChannel和EpollServerSocketChannel用于服务端
  Nio实现还是Epoll实现
NioSocketChannel，NioServerSocketChannel是NIO实现， EpollSocketChannel和EpollServerSocketChannel是Epoll实现
   Tips: Epoll实现参照 https://netty.io/wiki/native-transports.html
  NioSocketChannel(EpollSocketChannel)：代表异步的客户端 TCP Socket 连接 NioServerSocketChannel（EpollServerSocketChannel）：异步的服务器端 TCP Socket 连接 NioDatagramChannel：异步的 UDP 连接 NioSctpChannel：异步的客户端 Sctp 连接 NioSctpServerChannel：异步的 Sctp 服务器端连接 OioSocketChannel（OioSocketChannel）：同步的客户端 TCP Socket 连接 OioServerSocketChannel(Deprecated)：同步的服务器端 TCP Socket 连接 OioDatagramChannel(Deprecated)：同步的 UDP 连接 OioSctpChannel(Deprecated)：同步的 Sctp 服务器端连接 OioSctpServerChannel(Deprecated)：同步的客户端 TCP Socket 连接   Tips: 同步在源码中都已经标记为@Deprecated"><meta itemprop=datePublished content="2022-01-16T00:00:00+00:00"><meta itemprop=dateModified content="2022-01-16T23:30:55+08:00"><meta itemprop=wordCount content="523"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Netty五大组件之Channel"><meta name=twitter:description content="Netty版本：4.1.72.Final
 1. Channel概述 1.1 Channel介绍 Channel 一种连接到网络套接字或能够进行读、写、连接和绑定等I/O操作的组件。有如下特点：
 所有的I/O操作都是异步 Channel是分层的 向下转换以访问特定传输的操作 释放资源  看一下继承关系：
上图可以看出来可以从两个纬度来划分：
  服务端还是客户端
比如：NioSocketChannel和EpollSocketChannel用于客户端， NioServerSocketChannel和EpollServerSocketChannel用于服务端
  Nio实现还是Epoll实现
NioSocketChannel，NioServerSocketChannel是NIO实现， EpollSocketChannel和EpollServerSocketChannel是Epoll实现
   Tips: Epoll实现参照 https://netty.io/wiki/native-transports.html
  NioSocketChannel(EpollSocketChannel)：代表异步的客户端 TCP Socket 连接 NioServerSocketChannel（EpollServerSocketChannel）：异步的服务器端 TCP Socket 连接 NioDatagramChannel：异步的 UDP 连接 NioSctpChannel：异步的客户端 Sctp 连接 NioSctpServerChannel：异步的 Sctp 服务器端连接 OioSocketChannel（OioSocketChannel）：同步的客户端 TCP Socket 连接 OioServerSocketChannel(Deprecated)：同步的服务器端 TCP Socket 连接 OioDatagramChannel(Deprecated)：同步的 UDP 连接 OioSctpChannel(Deprecated)：同步的 Sctp 服务器端连接 OioSctpServerChannel(Deprecated)：同步的客户端 TCP Socket 连接   Tips: 同步在源码中都已经标记为@Deprecated"><link rel=preload href=/scss/main.min.e09cb23c7dff3bf1285aa0294bcdc4ac8194fb3425a99c621e31e7b871315685.css as=style><link href=/scss/main.min.e09cb23c7dff3bf1285aa0294bcdc4ac8194fb3425a99c621e31e7b871315685.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 321.39 78.54"><title id="title19">DUBBO LOGO</title><path class="cls-1" d="M68.46 50.38c0 14.06 11.39 22.11 25.45 22.11s25.45-8.05 25.45-22.11V7.25H68.46zm21.24-28h8.6V31H89.7zm0 22.25h8.6v8.6H89.7zM33.24 7.25H4.06v64H33.24c10.95.0 19.3-7.18 23.29-17.15a45.12 45.12.0 002.38-14.87A45.12 45.12.0 0056.53 24.4C52.84 14.62 44.19 7.25 33.24 7.25zm.43 14.63H30.34a3.44 3.44.0 00-3.44 3.44V53.23a3.44 3.44.0 003.44 3.44h3.33v4.63h-8.3a6.87 6.87.0 01-6.87-6.87V24.12a6.87 6.87.0 016.87-6.87h8.3zM285.51 6.06c-17.05.0-30.88 10.28-30.88 33.21s13.83 33.21 30.88 33.21 30.88-10.28 30.88-33.21S302.56 6.06 285.51 6.06zm7.59 48.36a6.87 6.87.0 01-6.87 6.87h-8.3V56.67h3.33a3.44 3.44.0 003.44-3.44V25.31a3.44 3.44.0 00-3.44-3.44h-3.33V17.25h8.3a6.87 6.87.0 016.87 6.87zm-53.4-17.56A17.39 17.39.0 00227.31 7.25H195.1v64h32.21a19.44 19.44.0 0012.38-34.44zM211.63 61.29h-6.08l18.68-44h6.08zM177 36.85A17.39 17.39.0 00164.65 7.25H132.43v64h32.21A19.44 19.44.0 00177 36.85zM149 61.29h-6.08l18.68-44h6.08z" style="fill:#fff;fill-opacity:1"/></svg></span><span class="text-uppercase font-weight-bold">蚂蚁背大象</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>Home</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Java</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/spring/><span>Spring</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/middlewares/><span class=active>Middleware</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/other/><span>Others</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002 站内搜索…" aria-label=站内搜索… autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002 站内搜索…" aria-label=站内搜索… autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Middleware</a></li><ul><li class="collapse show" id=middlewares><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Apache RocketMQ</a></li><ul><li class=collapse id=middlewaresrocketmq><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq/practice/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Apache RocketMQ 应用</a></li><ul><li class=collapse id=middlewaresrocketmqpractice><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqpracticerocketmq-slf4j-logging href=/middlewares/rocketmq/practice/rocketmq-slf4j-logging/>当SLF4J遇上RocketMQ</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqrocketmq-base-concept href=/middlewares/rocketmq/rocketmq-base-concept/>RocketMQ-基本概念</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqrocketmq-architecture-design href=/middlewares/rocketmq/rocketmq-architecture-design/>RocketMQ-架构设计</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqrocketmq-module-design href=/middlewares/rocketmq/rocketmq-module-design/>RocketMQ-模块设计</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqrocketmq-character href=/middlewares/rocketmq/rocketmq-character/>RocketMQ-特性</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq/name-server/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">RocketMQ Name Server</a></li><ul><li class=collapse id=middlewaresrocketmqname-server><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqname-servernameserver href=/middlewares/rocketmq/name-server/nameserver/>NameServer</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqname-serverrocketmq-analysis-nameserver-start href=/middlewares/rocketmq/name-server/rocketmq-analysis-nameserver-start/>RocketMQ源码解析-NameServer启动</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqname-serverrocketmq-analysis-broker-manage href=/middlewares/rocketmq/name-server/rocketmq-analysis-broker-manage/>RocketMQ源码解析-NameServer对Broker的管理</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq/broker/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">RocketMQ Broker</a></li><ul><li class=collapse id=middlewaresrocketmqbroker><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-start href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-start/>RocketMQ源码解析-Broker启动</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-nameserver-interaction href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-nameserver-interaction/>RocketMQ源码解析-Broker与NameServer交互</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-message-store href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-message-store/>RocketMQ源码解析-Broker消息存储设计与实现</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-commitlog href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-commitlog/>RocketMQ源码解析-Broker消息存储CommitLog</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-consumequeue href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-consumequeue/>RocketMQ源码解析-Broker消息存储ConsumeQueue</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-recevie-pull href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-recevie-pull/>RocketMQ源码解析-Broker接收拉取消息</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-failure-recovery href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-failure-recovery/>RocketMQ源码解析-Broker故障恢复</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-configfile href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-configfile/>RocketMQ源码解析-Broker存储配置文件说明</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqbrokerrocketmq-analysis-broker-tag-filter href=/middlewares/rocketmq/broker/rocketmq-analysis-broker-tag-filter/>RocketMQ源码解析-Broker 消息Tag过滤</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq/producer/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">RockerMQ 生产者</a></li><ul><li class=collapse id=middlewaresrocketmqproducer><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqproducerrocketmq-analysis-topic-create-strategy href=/middlewares/rocketmq/producer/rocketmq-analysis-topic-create-strategy/>RocketMQ源码解析-topic创建机制</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqproducerrocketmq-analysis-producer-msgsend-strategy href=/middlewares/rocketmq/producer/rocketmq-analysis-producer-msgsend-strategy/>RocketMQ源码解析-生产者投递消息策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqproducerrocketmq-analysis-producer-messagesend href=/middlewares/rocketmq/producer/rocketmq-analysis-producer-messagesend/>RocketMQ源码解析-producer发送消息的流程</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqproducerproducer href=/middlewares/rocketmq/producer/producer/>Producer</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq/consumer/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">RocketMQ 消费者</a></li><ul><li class=collapse id=middlewaresrocketmqconsumer><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqconsumerrocketmq-analysis-consumer href=/middlewares/rocketmq/consumer/rocketmq-analysis-consumer/>RocketMQ源码解析-消费者启动源码解析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqconsumerrocketmq-analysis-consumer-scheduledtask href=/middlewares/rocketmq/consumer/rocketmq-analysis-consumer-scheduledtask/>RocketMQ源码解析-消费者定时任务解析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqconsumerrocketmq-analysis-consumer-messagemodel href=/middlewares/rocketmq/consumer/rocketmq-analysis-consumer-messagemodel/>RocketMQ源码解析-消费模式消费进度加载源码解析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqconsumerrocketmq-analysis-consumer-concurrently href=/middlewares/rocketmq/consumer/rocketmq-analysis-consumer-concurrently/>RocketMQ源码解析-并发消费消息源码解析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqconsumerrocketmq-analysis-consumer-strategy href=/middlewares/rocketmq/consumer/rocketmq-analysis-consumer-strategy/>RocketMQ源码解析-消费者消费策略源码解析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqconsumerrocketmq-analysis-ack href=/middlewares/rocketmq/consumer/rocketmq-analysis-ack/>RocketMQ源码解析-RocketMQ消息ACK机制及消费进度管理</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqconsumerrocketmq-analysis-ordermessage-consume href=/middlewares/rocketmq/consumer/rocketmq-analysis-ordermessage-consume/>RocketMQ源码解析-RocketMQ顺序消息的投递与消费</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqconsumerrocketmq-analysis-consumer-repeat-consume href=/middlewares/rocketmq/consumer/rocketmq-analysis-consumer-repeat-consume/>RocketMQ源码解析-消费者重复消费</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq/issue/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">RocketMQ Issue</a></li><ul><li class=collapse id=middlewaresrocketmqissue><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqissuebroker-busy-issue href=/middlewares/rocketmq/issue/broker-busy-issue/>broker busy问题</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmqrocketmq-docker href=/middlewares/rocketmq/rocketmq-docker/>RocketMQ Docker部署</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq5/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Apache RocketMQ5</a></li><ul><li class=collapse id=middlewaresrocketmq5><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq5/quick-start/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">RocketMQ5.0 Quick start</a></li><ul><li class=collapse id=middlewaresrocketmq5quick-start><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmq5quick-startdledger-controller href=/middlewares/rocketmq5/quick-start/dledger-controller/>RocketMQ5.0 Controller DLedger模式</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/rocketmq5/store/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">RocketMQ5 Store</a></li><ul><li class=collapse id=middlewaresrocketmq5store><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmq5storecommitlog href=/middlewares/rocketmq5/store/commitlog/>RocketMQ55.0-CommitLog设计与源码解析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmq5storeautoswitchhaclient-source-code-analysis href=/middlewares/rocketmq5/store/autoswitchhaclient-source-code-analysis/>RocketMQ5.0源码分析-AutoSwitchHAClient</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmq5storecommitlog-important-attribute href=/middlewares/rocketmq5/store/commitlog-important-attribute/>RocketMQ5.0源码解析-CommitLog设计与几个重要的属性关系图文解析</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresrocketmq5habroker-elect-master href=/middlewares/rocketmq5/ha/broker-elect-master/>RocketMQ5.0主备自动切换模式Broker选主详解</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/netty/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Netty</a></li><ul><li class="collapse show" id=middlewaresnetty><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-annotation-sharable href=/middlewares/netty/netty-annotation-sharable/>Netty @Sharable到底是干什么用的</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/netty/netty-source-code-analysis/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Netty源码解析</a></li><ul><li class=collapse id=middlewaresnettynetty-source-code-analysis><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-analysis-sizeclasses href=/middlewares/netty/netty-source-code-analysis/netty-source-analysis-sizeclasses/>Netty源码解析-sizeClasses</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-analysis-pooled-manage href=/middlewares/netty/netty-source-code-analysis/netty-source-analysis-pooled-manage/>Netty源码解析-池化内存管理解析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-fastthreadlocal href=/middlewares/netty/netty-source-code-analysis/netty-fastthreadlocal/>Netty FastThreadLocal相比Java ThreadLocal到底快在哪里?</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-eventloopgroup-howto-work href=/middlewares/netty/netty-source-code-analysis/netty-eventloopgroup-howto-work/>Netty源码分析-EventLoopGroup如何工作</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-eventloop-base href=/middlewares/netty/netty-source-code-analysis/netty-eventloop-base/>Netty组件-EventLoop</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-components-channelhandler href=/middlewares/netty/netty-source-code-analysis/netty-components-channelhandler/>Netty组件-ChannelHandler</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-channelhandler-order href=/middlewares/netty/netty-source-code-analysis/netty-source-channelhandler-order/>Netty源码分析-ChannelHandler方法执行顺序和如何工作</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-decoder href=/middlewares/netty/netty-source-code-analysis/netty-source-decoder/>Netty源码解析-解码器(Decoder)是如何工作</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-cumulator href=/middlewares/netty/netty-source-code-analysis/netty-source-cumulator/>Netty源码解析-累加器(Cumulator)处理粘包半包问题</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-components-channelpipeline-channelcontext href=/middlewares/netty/netty-source-code-analysis/netty-components-channelpipeline-channelcontext/>Netty组件-ChannelHandlerContext和ChannelPipeline</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-channelread-object href=/middlewares/netty/netty-source-code-analysis/netty-source-channelread-object/>Netty源码解析-ChannelInboundHandler#channelRead参数Object对象到底是什么类型</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-serverbootstrap-flow href=/middlewares/netty/netty-source-code-analysis/netty-source-serverbootstrap-flow/>Netty源码解析-服务端启动流程详解</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-eventloop-startrun href=/middlewares/netty/netty-source-code-analysis/netty-source-eventloop-startrun/>Netty源码解析-EventLoop什么时候启动运行</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-source-code-analysisnetty-source-bossgroup-switch-workgroup href=/middlewares/netty/netty-source-code-analysis/netty-source-bossgroup-switch-workgroup/>Netty源码分析-Channel如何从主线程切换到从线程</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-bytebuf href=/middlewares/netty/netty-bytebuf/>Netty四大组件之ByteBuf</a>
<a class="td-sidebar-link td-sidebar-link__page active" id=m-middlewaresnettynetty-channel href=/middlewares/netty/netty-channel/>Netty五大组件之Channel</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/netty/netty-faq/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Netty答疑解惑</a></li><ul><li class=collapse id=middlewaresnettynetty-faq><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-faqnetty-faq-eventloopgroup-executor href=/middlewares/netty/netty-faq/netty-faq-eventloopgroup-executor/>Netty答疑解惑-EventLoopGroup执行器线程数小于nThreads会怎么样?</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-faqnetty-faq-components-relation href=/middlewares/netty/netty-faq/netty-faq-components-relation/>Netty答疑解惑-Netty组件之间的关系</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-eventloop href=/middlewares/netty/netty-eventloop/>Netty-EventLoop</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty href=/middlewares/netty/netty/>Netty</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-channelhandler href=/middlewares/netty/netty-channelhandler/>Netty-ChannelHandler组件</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresnettynetty-optimize href=/middlewares/netty/netty-optimize/>Netty优化</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/redis/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Redis</a></li><ul><li class=collapse id=middlewaresredis><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresredisredis-data-struct href=/middlewares/redis/redis-data-struct/>Redis底层-数据结构</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresredisredis-persistence href=/middlewares/redis/redis-persistence/>Redis持久化</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresredisredis-cluster href=/middlewares/redis/redis-cluster/>Redis集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresredisredis-cluster-strategy href=/middlewares/redis/redis-cluster-strategy/>Redis三种集群策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresredisredis-data-elimination-strategy href=/middlewares/redis/redis-data-elimination-strategy/>Redis数据淘汰策略</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/kafka/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Kafka</a></li><ul><li class=collapse id=middlewareskafka><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewareskafkakafka-base href=/middlewares/kafka/kafka-base/>kafka基本知识</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/etcd/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">ETCD</a></li><ul><li class=collapse id=middlewaresetcd><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresetcdetcd href=/middlewares/etcd/etcd/>ETCD</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/docker/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Docker</a></li><ul><li class=collapse id=middlewaresdocker><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/middlewares/docker/docker-base/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Docker基础知识</a></li><ul><li class=collapse id=middlewaresdockerdocker-base><a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresdockerdocker-basedocker-install href=/middlewares/docker/docker-base/docker-install/>Centos8 Docker安装</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresdockerdocker-basedocker-command href=/middlewares/docker/docker-base/docker-command/>Docker常见的命令</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresdockerdocker-basedockerfile href=/middlewares/docker/docker-base/dockerfile/>Dockfile</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-middlewaresdockerdocker-basedocker-compose-file href=/middlewares/docker/docker-base/docker-compose-file/>Docker Compose file</a></li></ul></ul></li></ul></ul></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/mxsm/mxsm-website/edit/main/content/en/middlewares/netty/Netty-channel.md target=_blank><i class="fa fa-edit fa-fw"></i> 编辑此页</a>
<a href="https://github.com/mxsm/mxsm-website/new/main/content/en/middlewares/netty/Netty-channel.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> 添加子页面</a>
<a href="https://github.com/mxsm/mxsm-website/issues/new?title=Netty%e4%ba%94%e5%a4%a7%e7%bb%84%e4%bb%b6%e4%b9%8bChannel" target=_blank><i class="fab fa-github fa-fw"></i> 提交文档问题</a>
<a href=https://github.com/mxsm/mxsm-website/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> 提交项目问题</a>
<a id=print href=/middlewares/netty/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#1-channel概述>1. Channel概述</a><ul><li><a href=#11-channel介绍>1.1 Channel介绍</a></li><li><a href=#12-channel-api>1.2 Channel API</a></li></ul></li><li><a href=#2-channel-创建>2 Channel 创建</a></li><li><a href=#3-channel初始化>3. Channel初始化</a></li></ul></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=/middlewares/>Middleware</a></li><li class=breadcrumb-item><a href=/middlewares/netty/>Netty</a></li><li class="breadcrumb-item active" aria-current=page><a href=/middlewares/netty/netty-channel/>Netty五大组件之Channel</a></li></ol></nav><div class=td-content><h1>Netty五大组件之Channel</h1><div class="td-byline mb-4"><time datetime=2022-01-16 class=text-muted>2022-01-16</time></div><blockquote><p>Netty版本：4.1.72.Final</p></blockquote><h3 id=1-channel概述>1. Channel概述</h3><h4 id=11-channel介绍>1.1 Channel介绍</h4><p><strong><code>Channel</code></strong> 一种连接到网络套接字或能够进行读、写、连接和绑定等I/O操作的组件。有如下特点：</p><ul><li>所有的I/O操作都是异步</li><li>Channel是分层的</li><li>向下转换以访问特定传输的操作</li><li>释放资源</li></ul><p>看一下继承关系：</p><p><img src=C:%5CUsers%5Cmxsm%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220116220623351.png alt=image-20220116220623351></p><p>上图可以看出来可以从两个纬度来划分：</p><ul><li><p>服务端还是客户端</p><p>比如：NioSocketChannel和EpollSocketChannel用于客户端， NioServerSocketChannel和EpollServerSocketChannel用于服务端</p></li><li><p>Nio实现还是Epoll实现</p><p>NioSocketChannel，NioServerSocketChannel是NIO实现， EpollSocketChannel和EpollServerSocketChannel是Epoll实现</p></li></ul><blockquote><p>Tips: Epoll实现参照 <a href=https://netty.io/wiki/native-transports.html>https://netty.io/wiki/native-transports.html</a></p></blockquote><ul><li>NioSocketChannel(EpollSocketChannel)：代表异步的客户端 TCP Socket 连接</li><li>NioServerSocketChannel（EpollServerSocketChannel）：异步的服务器端 TCP Socket 连接</li><li>NioDatagramChannel：异步的 UDP 连接</li><li>NioSctpChannel：异步的客户端 Sctp 连接</li><li>NioSctpServerChannel：异步的 Sctp 服务器端连接</li><li><del>OioSocketChannel（OioSocketChannel）：同步的客户端 TCP Socket 连接</del></li><li><del>OioServerSocketChannel(Deprecated)：同步的服务器端 TCP Socket 连接</del></li><li><del>OioDatagramChannel(Deprecated)：同步的 UDP 连接</del></li><li><del>OioSctpChannel(Deprecated)：同步的 Sctp 服务器端连接</del></li><li><del>OioSctpServerChannel(Deprecated)：同步的客户端 TCP Socket 连接</del></li></ul><blockquote><p>Tips: 同步在源码中都已经标记为@Deprecated</p></blockquote><h4 id=12-channel-api>1.2 Channel API</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>Channel</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AttributeMap</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ChannelOutboundInvoker</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Comparable</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Channel</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
    
    <span style=color:#000>ChannelId</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>EventLoop</span> <span style=color:#000>eventLoop</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>Channel</span> <span style=color:#000>parent</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>ChannelConfig</span> <span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isOpen</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isRegistered</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isActive</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>ChannelMetadata</span> <span style=color:#000>metadata</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>SocketAddress</span> <span style=color:#000>localAddress</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>SocketAddress</span> <span style=color:#000>remoteAddress</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>ChannelFuture</span> <span style=color:#000>closeFuture</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isWritable</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>bytesBeforeUnwritable</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>bytesBeforeWritable</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>Unsafe</span> <span style=color:#000>unsafe</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>ChannelPipeline</span> <span style=color:#000>pipeline</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>ByteBufAllocator</span> <span style=color:#000>alloc</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#5c35cc;font-weight:700>@Override</span>
    <span style=color:#000>Channel</span> <span style=color:#000>read</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#5c35cc;font-weight:700>@Override</span>
    <span style=color:#000>Channel</span> <span style=color:#000>flush</span><span style=color:#ce5c00;font-weight:700>();</span>
<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p>常用的说明如下：</p><table><thead><tr><th style=text-align:left>接口名</th><th style=text-align:left>描述</th></tr></thead><tbody><tr><td style=text-align:left>eventLoop()</td><td style=text-align:left>Channel需要注册到EventLoop的多路复用器上，用于处理I/O事件，通过eventLoop()方法可以获取到Channel注册EventLoop。</td></tr><tr><td style=text-align:left>pipeline()</td><td style=text-align:left>返回channel分配的ChannelPipeline</td></tr><tr><td style=text-align:left>isActive()</td><td style=text-align:left>判断channel是否激活。激活的意义取决于底层的传输类型。</td></tr><tr><td style=text-align:left>localAddress()</td><td style=text-align:left>返回本地的socket地址</td></tr><tr><td style=text-align:left>remoteAddress()</td><td style=text-align:left>返回远程的socket地址</td></tr><tr><td style=text-align:left>flush()</td><td style=text-align:left>将之前已写的数据冲刷到底层Channel上去</td></tr><tr><td style=text-align:left>write(Object msg)</td><td style=text-align:left>请求将当前的msg通过ChannelPipeline写入到目标Channel中。注意，write操作只是将消息存入到消息发送环形数组中，并没有真正被发送，只有调用flush操作才会被写入到Channel中，发送给对方。</td></tr><tr><td style=text-align:left>writeAndFlush()</td><td style=text-align:left>等同于调用write()并接着调用flush()</td></tr><tr><td style=text-align:left>metadate()</td><td style=text-align:left>当创建Socket的时候需要指定TCP参数，例如接收和发送的TCP缓冲区大小，TCP的超时时间。是否重用地址等。在Netty中，每个Channel对应一个物理链接，每个连接都有自己的TCP参数配置。所以，Channel会聚合一个ChannelMetadata用来对TCP参数提供元数据描述信息，通过metadata()方法就可以获取当前Channel的TCP参数配置。</td></tr><tr><td style=text-align:left>read()</td><td style=text-align:left>从当前的Channel中读取数据到第一个inbound缓冲区中，如果数据被成功读取，触发ChannelHandler.channelRead(ChannelHandlerContext,Object)事件。读取操作API调用完成后，紧接着会触发ChannelHander.channelReadComplete（ChannelHandlerContext）事件，这样业务的ChannelHandler可以决定是否需要继续读取数据。如果已经有操作请求被挂起，则后续的读操作会被忽略。</td></tr><tr><td style=text-align:left>close(ChannelPromise promise)</td><td style=text-align:left>主动关闭当前连接，通过ChannelPromise设置操作结果并进行结果通知，无论操作是否成功，都可以通过ChannelPromise获取操作结果。该操作会级联触发ChannelPipeline中所有ChannelHandler的ChannelHandler.close(ChannelHandlerContext，ChannelPromise)事件。</td></tr><tr><td style=text-align:left>parent()</td><td style=text-align:left>对于服务端Channel而言，它的父Channel为空；对于客户端Channel，它的父Channel就是创建它的ServerSocketChannel。</td></tr><tr><td style=text-align:left>id()</td><td style=text-align:left>返回ChannelId对象，ChannelId是Channel的唯一标识。</td></tr></tbody></table><p>接下来已Channel在服务端创建为例子，看一下Netty启动Channel创建的整个过程。创建分成了四个过程：</p><ul><li>Channel 创建</li><li>Channel 初始化</li><li>Channel 注册 EventLoop</li><li>Channel 绑定 ChannelPipeline</li></ul><h3 id=2-channel-创建>2 Channel 创建</h3><p>首先看一下例子(来自官网：https://netty.io/wiki/user-guide-for-4.x.html#wiki-h3-6)：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DiscardServer</span> <span style=color:#ce5c00;font-weight:700>{</span>
    
    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>;</span>
    
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>DiscardServer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>port</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>;</span>
    <span style=color:#ce5c00;font-weight:700>}</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>run</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
        <span style=color:#000>EventLoopGroup</span> <span style=color:#000>bossGroup</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>NioEventLoopGroup</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#8f5902;font-style:italic>// (1)
</span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>EventLoopGroup</span> <span style=color:#000>workerGroup</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>NioEventLoopGroup</span><span style=color:#ce5c00;font-weight:700>();</span>
        <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#000>ServerBootstrap</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ServerBootstrap</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#8f5902;font-style:italic>// (2)
</span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#000>b</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>group</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>bossGroup</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>workerGroup</span><span style=color:#ce5c00;font-weight:700>)</span>
             <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>channel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>NioServerSocketChannel</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// (3)
</span><span style=color:#8f5902;font-style:italic></span>             <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>childHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ChannelInitializer</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>SocketChannel</span><span style=color:#ce5c00;font-weight:700>&gt;()</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>// (4)
</span><span style=color:#8f5902;font-style:italic></span>                 <span style=color:#5c35cc;font-weight:700>@Override</span>
                 <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>initChannel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>SocketChannel</span> <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
                     <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>pipeline</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>addLast</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DiscardServerHandler</span><span style=color:#ce5c00;font-weight:700>());</span>
                 <span style=color:#ce5c00;font-weight:700>}</span>
             <span style=color:#ce5c00;font-weight:700>})</span>
             <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>option</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ChannelOption</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>SO_BACKLOG</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>128</span><span style=color:#ce5c00;font-weight:700>)</span>          <span style=color:#8f5902;font-style:italic>// (5)
</span><span style=color:#8f5902;font-style:italic></span>             <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>childOption</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ChannelOption</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>SO_KEEPALIVE</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// (6)
</span><span style=color:#8f5902;font-style:italic></span>    
            <span style=color:#8f5902;font-style:italic>// Bind and start to accept incoming connections.
</span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#000>ChannelFuture</span> <span style=color:#000>f</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>b</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bind</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>sync</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#8f5902;font-style:italic>// (7)
</span><span style=color:#8f5902;font-style:italic></span>    
            <span style=color:#8f5902;font-style:italic>// Wait until the server socket is closed.
</span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#8f5902;font-style:italic>// In this example, this does not happen, but you can do that to gracefully
</span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#8f5902;font-style:italic>// shut down your server.
</span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#000>f</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>channel</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>closeFuture</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>sync</span><span style=color:#ce5c00;font-weight:700>();</span>
        <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>finally</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#000>workerGroup</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>shutdownGracefully</span><span style=color:#ce5c00;font-weight:700>();</span>
            <span style=color:#000>bossGroup</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>shutdownGracefully</span><span style=color:#ce5c00;font-weight:700>();</span>
        <span style=color:#ce5c00;font-weight:700>}</span>
    <span style=color:#ce5c00;font-weight:700>}</span>
<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p>（3）中设置了**<code>NioServerSocketChannel</code>**，在 (7) 以上都是对 **<code>ServerBootstrap</code>** 进行设置，**<code>ChannelFuture f = b.bind(port).sync();</code>** 绑定端口，所以这里也是对 **Channel** 进行了创建。通过跟进代码发现最终是调用了 **<code>AbstractBootstrap#doBind</code>** 方法进行绑定，然后 调用**<code>AbstractBootstrap#initAndRegister</code>** 方法创建Channel同时初始化Channel。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>    <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ChannelFuture</span> <span style=color:#000>initAndRegister</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
        <span style=color:#000>Channel</span> <span style=color:#000>channel</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
        <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#000>channel</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>channelFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>newChannel</span><span style=color:#ce5c00;font-weight:700>();</span>
            <span style=color:#000>init</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>channel</span><span style=color:#ce5c00;font-weight:700>);</span>
        <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Throwable</span> <span style=color:#000>t</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>channel</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
                <span style=color:#8f5902;font-style:italic>// channel can be null if newChannel crashed (eg SocketException(&#34;too many open files&#34;))
</span><span style=color:#8f5902;font-style:italic></span>                <span style=color:#000>channel</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>unsafe</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>closeForcibly</span><span style=color:#ce5c00;font-weight:700>();</span>
                <span style=color:#8f5902;font-style:italic>// as the Channel is not registered yet we need to force the usage of the GlobalEventExecutor
</span><span style=color:#8f5902;font-style:italic></span>                <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DefaultChannelPromise</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>channel</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>GlobalEventExecutor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>INSTANCE</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>setFailure</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>t</span><span style=color:#ce5c00;font-weight:700>);</span>
            <span style=color:#ce5c00;font-weight:700>}</span>
            <span style=color:#8f5902;font-style:italic>// as the Channel is not registered yet we need to force the usage of the GlobalEventExecutor
</span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DefaultChannelPromise</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FailedChannel</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>GlobalEventExecutor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>INSTANCE</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>setFailure</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>t</span><span style=color:#ce5c00;font-weight:700>);</span>
        <span style=color:#ce5c00;font-weight:700>}</span>

        <span style=color:#000>ChannelFuture</span> <span style=color:#000>regFuture</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>group</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>register</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>channel</span><span style=color:#ce5c00;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>regFuture</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>cause</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>channel</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isRegistered</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
                <span style=color:#000>channel</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
            <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
                <span style=color:#000>channel</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>unsafe</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>closeForcibly</span><span style=color:#ce5c00;font-weight:700>();</span>
            <span style=color:#ce5c00;font-weight:700>}</span>
        <span style=color:#ce5c00;font-weight:700>}</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>regFuture</span><span style=color:#ce5c00;font-weight:700>;</span>
    <span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p>从代码中可以发现， Channel的创建是通过ChannelFactory创建。那么在(3)步的时候就是调用的 <strong><code>AbstractBootstrap#channel</code></strong> 方法：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>B</span> <span style=color:#000>channel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Class</span><span style=color:#ce5c00;font-weight:700>&lt;?</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>C</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>channelClass</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>channelFactory</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ReflectiveChannelFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>C</span><span style=color:#ce5c00;font-weight:700>&gt;(</span>
            <span style=color:#000>ObjectUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>checkNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>channelClass</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;channelClass&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
    <span style=color:#ce5c00;font-weight:700>));</span>
<span style=color:#ce5c00;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>ReflectiveChannelFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>Channel</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>ChannelFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>

    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Constructor</span><span style=color:#ce5c00;font-weight:700>&lt;?</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>constructor</span><span style=color:#ce5c00;font-weight:700>;</span>

    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ReflectiveChannelFactory</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Class</span><span style=color:#ce5c00;font-weight:700>&lt;?</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
        <span style=color:#000>ObjectUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>checkNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;clazz&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>constructor</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getConstructor</span><span style=color:#ce5c00;font-weight:700>();</span>
        <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>NoSuchMethodException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>IllegalArgumentException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Class &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>StringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>simpleClassName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span>
                    <span style=color:#4e9a06>&#34; does not have a public non-arg constructor&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>);</span>
        <span style=color:#ce5c00;font-weight:700>}</span>
    <span style=color:#ce5c00;font-weight:700>}</span>

    <span style=color:#5c35cc;font-weight:700>@Override</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>T</span> <span style=color:#000>newChannel</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>constructor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>newInstance</span><span style=color:#ce5c00;font-weight:700>();</span>
        <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Throwable</span> <span style=color:#000>t</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ChannelException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Unable to create Channel from class &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>constructor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDeclaringClass</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>t</span><span style=color:#ce5c00;font-weight:700>);</span>
        <span style=color:#ce5c00;font-weight:700>}</span>
    <span style=color:#ce5c00;font-weight:700>}</span>

    <span style=color:#5c35cc;font-weight:700>@Override</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>toString</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>StringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>simpleClassName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ReflectiveChannelFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span>
                <span style=color:#4e9a06>&#39;(&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>StringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>simpleClassName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>constructor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDeclaringClass</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;.class)&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
    <span style=color:#ce5c00;font-weight:700>}</span>
<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p><strong><code>最终是通过 NioServerSocketChannel的默认构造函数创建了对象</code></strong></p><h3 id=3-channel初始化>3. Channel初始化</h3><p><strong><code>AbstractBootstrap#initAndRegister</code></strong> 代码中创建了Channel上面代码已经分析了创建过程，在创建完成后调用了**<code>AbstractBootstrap#init</code>** 方法，在AbstractBootstrap中是一个抽象方法，也就是说具体有实现来确定，这个方法实现有两个类：</p><ul><li><strong>Bootstrap</strong></li><li><strong>ServerBootstrap</strong></li></ul><p>这里只讲ServerBootstrap的实现(前面也是针对Server部分来说明的，Client部分大同小异)，下面看一下 <strong><code>ServerBootstrap#init</code></strong> :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
</code></pre></div><br><div class=page-blank><div id=disqus_thread></div><script>(function(){var a=document,b=a.createElement('script');b.src='https://ljbmxsm.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/middlewares/netty/netty-eventloop/ class="btn btn-primary"><span class=mr-1>←</span> 上一页</a></li><a href=/middlewares/netty/netty-bytebuf/ class="btn btn-primary">下一页 <span class=ml-1>→</span></a></li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=https://groups.google.com/u/1/g/ljbmxsm><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=个人掘金主页 aria-label=个人掘金主页><a class=text-white target=_blank rel="noopener noreferrer" href=https://juejin.cn/user/1151943918492855><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/mxsm><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 The Docsy Authors All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank>隐私政策</a></small><p class=mt-2><a href=/about/>Home</a></p></div></div></div></footer><div><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script><script>$("p img").wrap(function(){return'<a data-fancybox="gallery" href="'+$(this).attr('src')+'"></a>'})</script></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/mermaid@8.8.1/dist/mermaid.min.js integrity=sha384-to2w0I1OqmbJ9J6yTnIX+KYU8grNpZoD1dKPLjgEJvMe5L5+/7qvuNa2sQo8WAWj crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js integrity="sha512-tBzZQxySO5q5lqwLWfu8Q+o4VkTcRGOeQGVQ0ueJga4A1RKuzmAu5HXDOXLEjpbKyV7ow9ympVoa6wZLEzRzDg==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.15.0/flowchart.min.js integrity="sha512-6QsSiIybtf8tuZ6xfjRTr2tdtw3Gp4q5RSCh2b6q9seoKEQmhAG1RrCA8F0kXTwivVxRVbp/YF3zOh8rvEAU7Q==" crossorigin=anonymous></script><script src=/js/main.min.b541b310f01941a0abfd76b652b5fb60dac470573775bb5b31ff08fe3f6cea51.js integrity="sha256-tUGzEPAZQaCr/Xa2UrX7YNrEcFc3dbtbMf8I/j9s6lE=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js></script><script type=text/javascript>docsearch({appId:'JO2SY3WDAC',apiKey:'324ddb3b679c1308e5aa8bf222e07f8b',indexName:'mxsm',inputSelector:'.td-search-input',debug:!1})</script></body></html>