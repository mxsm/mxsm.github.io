<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>分布式一致性算法Raft-理论篇 | 蚂蚁背大象</title><meta property="og:title" content="分布式一致性算法Raft-理论篇"><meta property="og:description" content="1. 什么是Raft？ Raft其实是一种分布式一致性算法(分布式共识算法)。核心还是和Paxos差不多但是更加便于理解和实现，Raft算法模块化的拆分以及相比Paxos更加简化的设计。实现Raft协议更加的简单，理解Raft算法也更加的容易(这一点可以参照Raft算法的论文给出来的报告)。主要拆分成了多个模块：
 领导人选举(Leader selection)： Raft集群启动，或者当存在的Leader节点发生故障，触发 Leader selection 。选举出来新的Leader 日志复制(Log replication)： Leader必须从客户端接收日志条目(Log entry),然后复制的其他的节点。同时强制要求其他节点日志必须和Leader日志一致 MemberShip变更： 在不停机整个Raft集群的情况做到变更集群的配置，替换宕机的机器或者改变复制集群。 Snapshot： 快照功能是为了实现日志的压缩  1.1 强Leader  系统中必须存在且同一时刻只能有一个 leader，只有 leader 可以接受 clients 发过来的请求（读写请求，可优化） Leader负责主动和所有的Follower进行通讯，负责分发Log Entry给Follower，同时统计Follower返回的ACK。 Leader通过向所有的Follower发送heartbeat维持Leader的地位  1.2 复制状态机 一致性算法是从复制状态机的背景下提出的：
 Client向Leader发送append Log entry请求 Leader先写本地Log,然后将Log复制到所有的Follower Leader收到多数Follower的应答(大于1/2),然后将Log entry对应的操作应用到状态机 Client收到Leader处理log entry结果  2.Raft的基本概念 2.1Raft的三种角色以及角色相互变动 将上面的图转换一下：
 Follower：完全被动，不能发送任何请求，只接受并响应来自 leader 和 candidate 的 message，每个节点启动后的初始状态一定是 follower。具体实现不一定要是Follower,可以是Candidate这个看具体情况。 Leader：处理所有来自Client请求，以及复制 log 到所有 followers。正常情况下所有的读写请求都经过Leader,但是这样会导致Leader的压力很大。同样这里也有优化的空间 Candidate：用来竞选一个新 leader （candidate 由 follower 触发超时而来）   服务器状态。跟随者只响应来自其他服务器的请求。如果跟随者接收不到消息，那么他就会变成候选人并发起一次选举。获得集群中大多数选票的候选人将成为领导人。在一个任期内，领导人一直都会是领导人，直到自己宕机了。
  Raft 把时间分割成任意长度的任期（Term）, 任期值按时间轴单调递增 每一个任期的开始都是 leader 选举，选举成功之后，leader 在任期内管理整个集群。也就是 election+normal operation 每个任期最多一个Leader,也有可能没有Leader,如上图的 Term t3  2."><meta property="og:type" content="article"><meta property="og:url" content="/other/theory-impl/raft/"><meta property="article:section" content="other"><meta property="article:published_time" content="2022-07-29T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-29T22:29:32+08:00"><meta property="og:site_name" content="蚂蚁背大象"><meta itemprop=name content="分布式一致性算法Raft-理论篇"><meta itemprop=description content="1. 什么是Raft？ Raft其实是一种分布式一致性算法(分布式共识算法)。核心还是和Paxos差不多但是更加便于理解和实现，Raft算法模块化的拆分以及相比Paxos更加简化的设计。实现Raft协议更加的简单，理解Raft算法也更加的容易(这一点可以参照Raft算法的论文给出来的报告)。主要拆分成了多个模块：
 领导人选举(Leader selection)： Raft集群启动，或者当存在的Leader节点发生故障，触发 Leader selection 。选举出来新的Leader 日志复制(Log replication)： Leader必须从客户端接收日志条目(Log entry),然后复制的其他的节点。同时强制要求其他节点日志必须和Leader日志一致 MemberShip变更： 在不停机整个Raft集群的情况做到变更集群的配置，替换宕机的机器或者改变复制集群。 Snapshot： 快照功能是为了实现日志的压缩  1.1 强Leader  系统中必须存在且同一时刻只能有一个 leader，只有 leader 可以接受 clients 发过来的请求（读写请求，可优化） Leader负责主动和所有的Follower进行通讯，负责分发Log Entry给Follower，同时统计Follower返回的ACK。 Leader通过向所有的Follower发送heartbeat维持Leader的地位  1.2 复制状态机 一致性算法是从复制状态机的背景下提出的：
 Client向Leader发送append Log entry请求 Leader先写本地Log,然后将Log复制到所有的Follower Leader收到多数Follower的应答(大于1/2),然后将Log entry对应的操作应用到状态机 Client收到Leader处理log entry结果  2.Raft的基本概念 2.1Raft的三种角色以及角色相互变动 将上面的图转换一下：
 Follower：完全被动，不能发送任何请求，只接受并响应来自 leader 和 candidate 的 message，每个节点启动后的初始状态一定是 follower。具体实现不一定要是Follower,可以是Candidate这个看具体情况。 Leader：处理所有来自Client请求，以及复制 log 到所有 followers。正常情况下所有的读写请求都经过Leader,但是这样会导致Leader的压力很大。同样这里也有优化的空间 Candidate：用来竞选一个新 leader （candidate 由 follower 触发超时而来）   服务器状态。跟随者只响应来自其他服务器的请求。如果跟随者接收不到消息，那么他就会变成候选人并发起一次选举。获得集群中大多数选票的候选人将成为领导人。在一个任期内，领导人一直都会是领导人，直到自己宕机了。
  Raft 把时间分割成任意长度的任期（Term）, 任期值按时间轴单调递增 每一个任期的开始都是 leader 选举，选举成功之后，leader 在任期内管理整个集群。也就是 election+normal operation 每个任期最多一个Leader,也有可能没有Leader,如上图的 Term t3  2."><meta itemprop=datePublished content="2022-07-29T00:00:00+00:00"><meta itemprop=dateModified content="2022-07-29T22:29:32+08:00"><meta itemprop=wordCount content="414"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="分布式一致性算法Raft-理论篇"><meta name=twitter:description content="1. 什么是Raft？ Raft其实是一种分布式一致性算法(分布式共识算法)。核心还是和Paxos差不多但是更加便于理解和实现，Raft算法模块化的拆分以及相比Paxos更加简化的设计。实现Raft协议更加的简单，理解Raft算法也更加的容易(这一点可以参照Raft算法的论文给出来的报告)。主要拆分成了多个模块：
 领导人选举(Leader selection)： Raft集群启动，或者当存在的Leader节点发生故障，触发 Leader selection 。选举出来新的Leader 日志复制(Log replication)： Leader必须从客户端接收日志条目(Log entry),然后复制的其他的节点。同时强制要求其他节点日志必须和Leader日志一致 MemberShip变更： 在不停机整个Raft集群的情况做到变更集群的配置，替换宕机的机器或者改变复制集群。 Snapshot： 快照功能是为了实现日志的压缩  1.1 强Leader  系统中必须存在且同一时刻只能有一个 leader，只有 leader 可以接受 clients 发过来的请求（读写请求，可优化） Leader负责主动和所有的Follower进行通讯，负责分发Log Entry给Follower，同时统计Follower返回的ACK。 Leader通过向所有的Follower发送heartbeat维持Leader的地位  1.2 复制状态机 一致性算法是从复制状态机的背景下提出的：
 Client向Leader发送append Log entry请求 Leader先写本地Log,然后将Log复制到所有的Follower Leader收到多数Follower的应答(大于1/2),然后将Log entry对应的操作应用到状态机 Client收到Leader处理log entry结果  2.Raft的基本概念 2.1Raft的三种角色以及角色相互变动 将上面的图转换一下：
 Follower：完全被动，不能发送任何请求，只接受并响应来自 leader 和 candidate 的 message，每个节点启动后的初始状态一定是 follower。具体实现不一定要是Follower,可以是Candidate这个看具体情况。 Leader：处理所有来自Client请求，以及复制 log 到所有 followers。正常情况下所有的读写请求都经过Leader,但是这样会导致Leader的压力很大。同样这里也有优化的空间 Candidate：用来竞选一个新 leader （candidate 由 follower 触发超时而来）   服务器状态。跟随者只响应来自其他服务器的请求。如果跟随者接收不到消息，那么他就会变成候选人并发起一次选举。获得集群中大多数选票的候选人将成为领导人。在一个任期内，领导人一直都会是领导人，直到自己宕机了。
  Raft 把时间分割成任意长度的任期（Term）, 任期值按时间轴单调递增 每一个任期的开始都是 leader 选举，选举成功之后，leader 在任期内管理整个集群。也就是 election+normal operation 每个任期最多一个Leader,也有可能没有Leader,如上图的 Term t3  2."><link rel=preload href=/scss/main.min.e09cb23c7dff3bf1285aa0294bcdc4ac8194fb3425a99c621e31e7b871315685.css as=style><link href=/scss/main.min.e09cb23c7dff3bf1285aa0294bcdc4ac8194fb3425a99c621e31e7b871315685.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 321.39 78.54"><title id="title19">DUBBO LOGO</title><path class="cls-1" d="M68.46 50.38c0 14.06 11.39 22.11 25.45 22.11s25.45-8.05 25.45-22.11V7.25H68.46zm21.24-28h8.6V31H89.7zm0 22.25h8.6v8.6H89.7zM33.24 7.25H4.06v64H33.24c10.95.0 19.3-7.18 23.29-17.15a45.12 45.12.0 002.38-14.87A45.12 45.12.0 0056.53 24.4C52.84 14.62 44.19 7.25 33.24 7.25zm.43 14.63H30.34a3.44 3.44.0 00-3.44 3.44V53.23a3.44 3.44.0 003.44 3.44h3.33v4.63h-8.3a6.87 6.87.0 01-6.87-6.87V24.12a6.87 6.87.0 016.87-6.87h8.3zM285.51 6.06c-17.05.0-30.88 10.28-30.88 33.21s13.83 33.21 30.88 33.21 30.88-10.28 30.88-33.21S302.56 6.06 285.51 6.06zm7.59 48.36a6.87 6.87.0 01-6.87 6.87h-8.3V56.67h3.33a3.44 3.44.0 003.44-3.44V25.31a3.44 3.44.0 00-3.44-3.44h-3.33V17.25h8.3a6.87 6.87.0 016.87 6.87zm-53.4-17.56A17.39 17.39.0 00227.31 7.25H195.1v64h32.21a19.44 19.44.0 0012.38-34.44zM211.63 61.29h-6.08l18.68-44h6.08zM177 36.85A17.39 17.39.0 00164.65 7.25H132.43v64h32.21A19.44 19.44.0 00177 36.85zM149 61.29h-6.08l18.68-44h6.08z" style="fill:#fff;fill-opacity:1"/></svg></span><span class="text-uppercase font-weight-bold">蚂蚁背大象</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>Home</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Java</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/spring/><span>Spring</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/middlewares/><span>Middleware</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/other/><span class=active>Others</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002 站内搜索…" aria-label=站内搜索… autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002 站内搜索…" aria-label=站内搜索… autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Others</a></li><ul><li class="collapse show" id=other><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/apache-shiro/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Shiro</a></li><ul><li class=collapse id=otherapache-shiro><a class="td-sidebar-link td-sidebar-link__page" id=m-otherapache-shiroterminology href=/other/apache-shiro/terminology/>Shiro术语</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/dubbo/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Dubbo</a></li><ul><li class=collapse id=otherdubbo><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/dubbo/source-analyse/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Dubbo源码解析</a></li><ul><li class=collapse id=otherdubbosource-analyse><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbosource-analyseimplicit-parameter href=/other/dubbo/source-analyse/implicit-parameter/>Dubbo隐式参数</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbosource-analysedubbo-protocol href=/other/dubbo/source-analyse/dubbo-protocol/>Dubbo Protocol说明</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbosource-analyseextensionloader href=/other/dubbo/source-analyse/extensionloader/>ExtensionLoader源码解析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbosource-analysereferenceconfig href=/other/dubbo/source-analyse/referenceconfig/>ReferenceConfig分析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbosource-analyseserviceconfig href=/other/dubbo/source-analyse/serviceconfig/>ServiceConfig源码分析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbosource-analyseadaptive-mechanism href=/other/dubbo/source-analyse/adaptive-mechanism/>自适应机制解析</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbodubbo-fault-tolerant-servicedir href=/other/dubbo/dubbo-fault-tolerant-servicedir/>Dubbo容错四大利器之—服务目录</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbodubbo-metadata href=/other/dubbo/dubbo-metadata/>Dubbo元数据</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbodubbo-fault-tolerant-serviceroute href=/other/dubbo/dubbo-fault-tolerant-serviceroute/>Dubbo容错四大利器之— 服务路由</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbodubbo-fault-tolerant-cluster href=/other/dubbo/dubbo-fault-tolerant-cluster/>Dubbo容错四大利器之—集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbodubbo-freamwork-design href=/other/dubbo/dubbo-freamwork-design/>Dubbo框架设计</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubboconfig-model-analysis href=/other/dubbo/config-model-analysis/>Config模块分析</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdubbodubbo-fault-tolerant-loadbalance href=/other/dubbo/dubbo-fault-tolerant-loadbalance/>Dubbo容错四大利器之—负载均衡</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/git/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Git</a></li><ul><li class=collapse id=othergit><a class="td-sidebar-link td-sidebar-link__page" id=m-othergitgit-project-init href=/other/git/git-project-init/>如何将本地已有项目关联到github的新建的项目中</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-othergitgit-version-back href=/other/git/git-version-back/>Git版本回退</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-othergitgit-command-tag href=/other/git/git-command-tag/>Git常用命令-Tag</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/maven/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Maven</a></li><ul><li class=collapse id=othermaven><a class="td-sidebar-link td-sidebar-link__page" id=m-othermavenmaven-mvnd href=/other/maven/maven-mvnd/>maven-mvnd比maven更快的mave</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-othermavenmaven-custom-archetype href=/other/maven/maven-custom-archetype/>Maven-自定义archetype</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/mybatis/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Mybatis</a></li><ul><li class=collapse id=othermybatis><a class="td-sidebar-link td-sidebar-link__page" id=m-othermybatismybatis-theory-sql-execute href=/other/mybatis/mybatis-theory-sql-execute/>深入理解mybatis原理-SQL的执行过程</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-othermybatismybatis-theory-mybatis-design href=/other/mybatis/mybatis-theory-mybatis-design/>深入理解mybatis原理-MyBatis的架构设计</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-othermybatismybatis-theory-xml-parse href=/other/mybatis/mybatis-theory-xml-parse/>深入理解mybatis原理-MyBatis配置xml文件解析</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">数据库</a></li><ul><li class=collapse id=otherdb><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/elasticsearch/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Elasticsearch</a></li><ul><li class=collapse id=otherdbelasticsearch><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/elasticsearch/mapping/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Elasticsearch Mapping</a></li><ul><li class=collapse id=otherdbelasticsearchmapping><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbelasticsearchmappingelasticsearch-metadata href=/other/db/elasticsearch/mapping/elasticsearch-metadata/>Elasticsearch-元数据</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/elasticsearch/search-dsl/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Elasticsearch 查询DSL</a></li><ul><li class=collapse id=otherdbelasticsearchsearch-dsl><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/elasticsearch/search-dsl/complex-search/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">复合查询</a></li><ul><li class=collapse id=otherdbelasticsearchsearch-dslcomplex-search><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbelasticsearchsearch-dslcomplex-searchelasticsearch-boosting-query href=/other/db/elasticsearch/search-dsl/complex-search/elasticsearch-boosting-query/>Elasticsearch复合查询-boosting query查询</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbelasticsearchsearch-dslcomplex-searchelasticsearch-constant-score-query href=/other/db/elasticsearch/search-dsl/complex-search/elasticsearch-constant-score-query/>Elasticsearch复合查询-Constant score query查询</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbelasticsearchsearch-dslcomplex-searchelasticsearch-boolean href=/other/db/elasticsearch/search-dsl/complex-search/elasticsearch-boolean/>Elasticsearch复合查询-Boolean查询</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbelasticsearchsearch-dslcomplex-searchelasticsearch-disjunction-max-query href=/other/db/elasticsearch/search-dsl/complex-search/elasticsearch-disjunction-max-query/>Elasticsearch复合查询-Disjunction max query</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/elasticsearch/index/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Elasticsearch 索引</a></li><ul><li class=collapse id=otherdbelasticsearchindex><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbelasticsearchindexelasticsearch-index-mode href=/other/db/elasticsearch/index/elasticsearch-index-mode/>Elasticsearch-索引模式</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbelasticsearchelasticsearch-basic-conception href=/other/db/elasticsearch/elasticsearch-basic-conception/>elasticsearch基本概念</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/mysql/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">mysql</a></li><ul><li class=collapse id=otherdbmysql><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlcommand href=/other/db/mysql/command/>mysql命令</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/mysql/mysql-base/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Mysql基础知识</a></li><ul><li class=collapse id=otherdbmysqlmysql-base><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-basemysql-index-1 href=/other/db/mysql/mysql-base/mysql-index-1/>mysql索引1-索引如何组织数据</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-basemysql-index-2 href=/other/db/mysql/mysql-base/mysql-index-2/>mysql索引2-索引分类</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-basemysql-index-3 href=/other/db/mysql/mysql-base/mysql-index-3/>mysql索引3-索引匹配和SQL优化</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-basemysql-indexs href=/other/db/mysql/mysql-base/mysql-indexs/>MySQL几种索引的区别</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-baseline-overflow href=/other/db/mysql/mysql-base/line-overflow/>行溢出</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-basestorage-engine href=/other/db/mysql/mysql-base/storage-engine/>存储引擎</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-basemysql-optimize href=/other/db/mysql/mysql-base/mysql-optimize/>MySQL的优化</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-basemysql-master-slave-theory href=/other/db/mysql/mysql-base/mysql-master-slave-theory/>MySQL主从复制原理</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/mysql/mysql-note/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Mysql笔记</a></li><ul><li class=collapse id=otherdbmysqlmysql-note><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/mysql/mysql-note/index/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Mysql索引</a></li><ul><li class=collapse id=otherdbmysqlmysql-noteindex><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-noteindexhigh-performance-index href=/other/db/mysql/mysql-note/index/high-performance-index/>高性能索引策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-noteindexindex-type href=/other/db/mysql/mysql-note/index/index-type/>索引的类型</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-noteschema-datatype-optimization href=/other/db/mysql/mysql-note/schema-datatype-optimization/>Schema与数据类型优化</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-notequery-optimization href=/other/db/mysql/mysql-note/query-optimization/>查询性能优化</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/mysql/mysql-innodb/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">InnoDB存储引擎</a></li><ul><li class=collapse id=otherdbmysqlmysql-innodb><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-innodbinnodb-index href=/other/db/mysql/mysql-innodb/innodb-index/>mysql innodb 索引</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-innodbinnodb-cardinality href=/other/db/mysql/mysql-innodb/innodb-cardinality/>mysql引擎InnoDB索引中的cardinality关键字</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-innodbinnodb-table href=/other/db/mysql/mysql-innodb/innodb-table/>InnoDB表</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-innodbinnodb-lock href=/other/db/mysql/mysql-innodb/innodb-lock/>Mysql InnoDB 锁</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-innodbmysql-explain href=/other/db/mysql/mysql-innodb/mysql-explain/>Explain执行计划</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-innodbinnodb-crash-recovery href=/other/db/mysql/mysql-innodb/innodb-crash-recovery/>InnoDb崩溃恢复</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/db/mysql/mysql-issue/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">mysql使用过程中的问题</a></li><ul><li class=collapse id=otherdbmysqlmysql-issue><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbmysqlmysql-issuemysql-docker-cannot-conn href=/other/db/mysql/mysql-issue/mysql-docker-cannot-conn/>虚拟机VMware的Linux系统挂起后 docker中的mysql容器无法访问</a></li></ul></ul></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbcreate-index-principle href=/other/db/create-index-principle/>建立索引原则</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbdatabase-transaction href=/other/db/database-transaction/>数据库事务</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdbform-notform href=/other/db/form-notform/>范式和反范式</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/data-structure/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">数据结构</a></li><ul><li class=collapse id=otherdata-structure><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdata-structurebinary-search-tree href=/other/data-structure/binary-search-tree/>二叉搜索树</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdata-structurebinary-tree href=/other/data-structure/binary-tree/>二叉树</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdata-structurered-black-tree href=/other/data-structure/red-black-tree/>红黑树</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/algorithm/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">算法</a></li><ul><li class=collapse id=otheralgorithm><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/algorithm/sort-algorithm/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">排序算法</a></li><ul><li class=collapse id=otheralgorithmsort-algorithm><a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmsort-algorithmbubble-sort href=/other/algorithm/sort-algorithm/bubble-sort/>冒泡排序</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmsort-algorithmsort-algorithm href=/other/algorithm/sort-algorithm/sort-algorithm/>排序算法</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmsort-algorithmmerge-sort href=/other/algorithm/sort-algorithm/merge-sort/>归并排序</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmsort-algorithmshell-sort href=/other/algorithm/sort-algorithm/shell-sort/>希尔排序</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmsort-algorithmquick-sort href=/other/algorithm/sort-algorithm/quick-sort/>快速排序</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmsort-algorithmselection-sort href=/other/algorithm/sort-algorithm/selection-sort/>选择排序</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmsort-algorithminsertion-sort href=/other/algorithm/sort-algorithm/insertion-sort/>插入排序</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/algorithm/five-base-algorithm/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">五大基本算法</a></li><ul><li class=collapse id=otheralgorithmfive-base-algorithm><a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmfive-base-algorithmdp href=/other/algorithm/five-base-algorithm/dp/>五大基本算法之动态规划</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/algorithm/graph-traversal/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">图遍历</a></li><ul><li class=collapse id=otheralgorithmgraph-traversal><a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmgraph-traversaldfs href=/other/algorithm/graph-traversal/dfs/>深度优先搜索-DFS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheralgorithmgraph-traversalbfs href=/other/algorithm/graph-traversal/bfs/>广度优先搜索-BFS</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/design-patterns/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">设计模式</a></li><ul><li class=collapse id=otherdesign-patterns><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/design-patterns/creational-patterns/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">创建模式</a></li><ul><li class=collapse id=otherdesign-patternscreational-patterns><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdesign-patternscreational-patternsabstract-factory-mode href=/other/design-patterns/creational-patterns/abstract-factory-mode/>抽象工厂模式</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdesign-patternscreational-patternsfactory-methodmode href=/other/design-patterns/creational-patterns/factory-methodmode/>工厂方法模式</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdesign-patternscreational-patternsbuilder-mode href=/other/design-patterns/creational-patterns/builder-mode/>建造者模式</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdesign-patternscreational-patternssimple-factory-mode href=/other/design-patterns/creational-patterns/simple-factory-mode/>简单工厂模式</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdesign-patternscreational-patternssingleton-mode href=/other/design-patterns/creational-patterns/singleton-mode/>单例模式</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/design-patterns/behavioral-patterns/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">结构模式</a></li><ul><li class=collapse id=otherdesign-patternsbehavioral-patterns></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/design-patterns/structural-patterns/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">行为模式</a></li><ul><li class=collapse id=otherdesign-patternsstructural-patterns><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdesign-patternsstructural-patternsadapter-mode href=/other/design-patterns/structural-patterns/adapter-mode/>适配器模式</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdesign-patternsread-uml href=/other/design-patterns/read-uml/>看懂UML图</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/idea/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">IntelliJ IDEA</a></li><ul><li class=collapse id=otheridea><a class="td-sidebar-link td-sidebar-link__page" id=m-otherideaintellij-idea-setting href=/other/idea/intellij-idea-setting/>IntelliJ IDEA常用设置</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherideaintellij-idea-skills href=/other/idea/intellij-idea-skills/>IntelliJ IDEA那些不常用但很有用技巧</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/sso/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">单点登录</a></li><ul><li class=collapse id=othersso><a class="td-sidebar-link td-sidebar-link__page" id=m-otherssocas-docker-deploye href=/other/sso/cas-docker-deploye/>CAS Docker部署</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/develop-tools/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">”开发工具"</a></li><ul><li class=collapse id=otherdevelop-tools><a class="td-sidebar-link td-sidebar-link__page" id=m-otherdevelop-toolsarthas-ingenious-use-1 href=/other/develop-tools/arthas-ingenious-use-1/>Arthas使用实践-方法性能调优</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherdevelop-toolsuntitled href=/other/develop-tools/untitled/></a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-otherwindows-wsl href=/other/windows-wsl/>Windows WSL让你告别VMware</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/serialize/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">序列化</a></li><ul><li class=collapse id=otherserialize><a class="td-sidebar-link td-sidebar-link__page" id=m-otherserializefastjson-desensitization href=/other/serialize/fastjson-desensitization/>fastjson序列化脱敏实现</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/oauth2/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">OAuth2</a></li><ul><li class=collapse id=otheroauth2><a class="td-sidebar-link td-sidebar-link__page" id=m-otheroauth2oauth2-overview href=/other/oauth2/oauth2-overview/>从IETF规范理解OAuth 2.0</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheroauth2oauth2-authorization-code-grant href=/other/oauth2/oauth2-authorization-code-grant/>OAuth2-授权码模式图解(Authorization Code Grant)</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otheroauth2oauth2-implicit-grant href=/other/oauth2/oauth2-implicit-grant/>OAuth2-隐式授权详解(Implicit Grant)</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-otherminio href=/other/minio/>分布式文件系统MinIO环境的搭建</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherfast-build-develop-env href=/other/fast-build-develop-env/>如何快速搭建Java项目开发环境</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherjmeter-faker href=/other/jmeter-faker/>JMeter+Faker让测试数据生成自动化</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-otherhow-to-use-lock href=/other/how-to-use-lock/>开发中分布式锁和本地锁如何取舍</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/other/theory-impl/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">理论实现</a></li><ul><li class="collapse show" id=othertheory-impl><a class="td-sidebar-link td-sidebar-link__page" id=m-othertheory-impltimingwheel href=/other/theory-impl/timingwheel/>时间轮-理论篇</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-othertheory-impltimingwheel-impl href=/other/theory-impl/timingwheel-impl/>时间轮-实现篇</a>
<a class="td-sidebar-link td-sidebar-link__page active" id=m-othertheory-implraft href=/other/theory-impl/raft/>分布式一致性算法Raft-理论篇</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-othergithub-actions-how-deploymaven href=/other/github-actions-how-deploymaven/>如何使用GitHub Actions自动发布JAR到Maven中央仓库</a></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/mxsm/mxsm-website/edit/main/content/en/other/theory-impl/raft.md target=_blank><i class="fa fa-edit fa-fw"></i> 编辑此页</a>
<a href="https://github.com/mxsm/mxsm-website/new/main/content/en/other/theory-impl/raft.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> 添加子页面</a>
<a href="https://github.com/mxsm/mxsm-website/issues/new?title=%e5%88%86%e5%b8%83%e5%bc%8f%e4%b8%80%e8%87%b4%e6%80%a7%e7%ae%97%e6%b3%95Raft-%e7%90%86%e8%ae%ba%e7%af%87" target=_blank><i class="fab fa-github fa-fw"></i> 提交文档问题</a>
<a href=https://github.com/mxsm/mxsm-website/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> 提交项目问题</a>
<a id=print href=/other/theory-impl/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#1-什么是raft>1. 什么是Raft？</a><ul><li><a href=#11-强leader>1.1 强Leader</a></li><li><a href=#12-复制状态机>1.2 复制状态机</a></li></ul></li><li><a href=#2raft的基本概念>2.Raft的基本概念</a><ul><li><a href=#21raft的三种角色以及角色相互变动>2.1Raft的三种角色以及角色相互变动</a></li><li><a href=#22-服务节点状态>2.2 服务节点状态</a></li><li><a href=#23-raft中三类rpc>2.3 Raft中三类RPC</a></li><li><a href=#24-raft算法特性总结>2.4 Raft算法特性总结</a></li><li><a href=#25-安全性说明>2.5 安全性说明</a></li><li><a href=#选举限制><strong>选举限制</strong></a></li><li><a href=#提交之前任期内的日志条目>提交之前任期内的日志条目</a></li></ul></li><li><a href=#3-raft功能>3. Raft功能</a><ul><li><a href=#31-领导人选举leader-election>3.1 领导人选举（Leader election）</a></li><li><a href=#32-日志复制>3.2 日志复制</a></li><li><a href=#33-committed-index>3.3 Committed Index</a></li><li><a href=#33-日志压缩log-snapshot>3.3 日志压缩(Log Snapshot)</a></li></ul></li><li><a href=#4-raft集群成员变化>4. Raft集群成员变化</a></li><li><a href=#5-raft的优化>5. Raft的优化</a></li></ul></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=/other/>Others</a></li><li class=breadcrumb-item><a href=/other/theory-impl/>理论实现</a></li><li class="breadcrumb-item active" aria-current=page><a href=/other/theory-impl/raft/>分布式一致性算法Raft-理论篇</a></li></ol></nav><div class=td-content><h1>分布式一致性算法Raft-理论篇</h1><h3 id=1-什么是raft>1. 什么是Raft？</h3><p><a href=https://raft.github.io/>Raft</a>其实是一种分布式一致性算法(分布式共识算法)。核心还是和Paxos差不多但是更加便于理解和实现，Raft算法模块化的拆分以及相比Paxos更加简化的设计。实现Raft协议更加的简单，理解Raft算法也更加的容易(这一点可以参照<a href=https://raft.github.io/raft.pdf>Raft算法的论文</a>给出来的报告)。主要拆分成了多个模块：</p><ul><li><strong>领导人选举(Leader selection)：</strong> Raft集群启动，或者当存在的Leader节点发生故障，触发 <code>Leader selection</code> 。选举出来新的Leader</li><li><strong>日志复制(Log replication)：</strong> Leader必须从客户端接收日志条目(Log entry),然后复制的其他的节点。同时强制要求其他节点日志必须和Leader日志一致</li><li><strong>MemberShip变更：</strong> 在不停机整个Raft集群的情况做到变更集群的配置，替换宕机的机器或者改变复制集群。</li><li><strong>Snapshot：</strong> 快照功能是为了实现日志的压缩</li></ul><h4 id=11-强leader>1.1 强Leader</h4><ol><li>系统中必须存在且同一时刻只能有一个 leader，只有 leader 可以接受 clients 发过来的请求（读写请求，可优化）</li><li>Leader负责主动和所有的Follower进行通讯，负责分发Log Entry给Follower，同时统计Follower返回的ACK。</li><li>Leader通过向所有的Follower发送heartbeat维持Leader的地位</li></ol><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/Strong%20Leader.png alt="Strong Leader"></p><h4 id=12-复制状态机>1.2 复制状态机</h4><p>一致性算法是从复制状态机的背景下提出的：</p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE1.png alt></p><ol><li>Client向Leader发送append Log entry请求</li><li>Leader先写本地Log,然后将Log复制到所有的Follower</li><li>Leader收到多数Follower的应答(大于1/2),然后将Log entry对应的操作应用到状态机</li><li>Client收到Leader处理log entry结果</li></ol><h3 id=2raft的基本概念>2.Raft的基本概念</h3><h4 id=21raft的三种角色以及角色相互变动>2.1Raft的三种角色以及角色相互变动</h4><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE4.png alt></p><p>将上面的图转换一下：</p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/Raft%20role%20change.png alt="Raft role change"></p><ol><li>Follower：完全被动，不能发送任何请求，只接受并响应来自 leader 和 candidate 的 message，每个节点启动后的初始状态一定是 follower。<strong>具体实现不一定要是Follower,可以是Candidate这个看具体情况。</strong></li><li>Leader：处理所有来自Client请求，以及复制 log 到所有 followers。正常情况下所有的读写请求都经过Leader,但是这样会导致Leader的压力很大。同样这里也有优化的空间</li><li>Candidate：用来竞选一个新 leader （candidate 由 follower 触发超时而来）</li></ol><blockquote><p>服务器状态。跟随者只响应来自其他服务器的请求。如果跟随者接收不到消息，那么他就会变成候选人并发起一次选举。获得集群中大多数选票的候选人将成为领导人。在一个任期内，领导人一直都会是领导人，直到自己宕机了。</p></blockquote><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE5.png alt></p><ul><li>Raft 把时间分割成任意长度的<strong>任期（Term）</strong>, 任期值按时间轴单调递增</li><li>每一个任期的开始都是 leader 选举，选举成功之后，leader 在任期内管理整个集群。也就是 <strong>election+normal operation</strong></li><li>每个任期最多一个Leader,也有可能没有Leader,如上图的 <strong>Term t3</strong></li></ul><h4 id=22-服务节点状态>2.2 服务节点状态</h4><p><strong>所有服务节点的持久性状态 (在响应 RPC 请求之前，已经更新到了稳定的存储设备)：</strong></p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td><strong>currentTerm</strong></td><td>服务器已知最新的任期（在服务器首次启动时初始化为0，单调递增）</td></tr><tr><td><strong>votedFor</strong></td><td>当前任期内收到选票的 candidateId，如果没有投给任何候选人 则为空</td></tr><tr><td><strong>log[]</strong></td><td>日志条目；每个条目包含了用于状态机的命令，以及领导人接收到该条目时的任期（初始索引为1）</td></tr></tbody></table><p><strong>所有服务节点的易失性状态：</strong></p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>commitIndex</td><td>已知已提交的最高的日志条目的索引（初始值为0，单调递增）</td></tr><tr><td>lastApplied</td><td>已经被应用到状态机的最高的日志条目的索引（初始值为0，单调递增）</td></tr></tbody></table><p><strong>Leader上的易失性状态 (选举后已经重新初始化)：</strong></p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>nextIndex[]</td><td>对于每一台服务器，发送到该服务器的下一个日志条目的索引（初始值为领导人最后的日志条目的索引+1）</td></tr><tr><td>matchIndex[]</td><td>对于每一台服务器，已知的已经复制到该服务器的最高日志条目的索引（初始值为0，单调递增）</td></tr></tbody></table><h4 id=23-raft中三类rpc>2.3 Raft中三类RPC</h4><p><strong>RequestVote RPC(选举投票)：</strong> 由Candidate发出的用于选举投票Leader的RPC请求</p><p><strong>AppendEntries RPC(追加Log Entry)：</strong> 由领导人调用，用于日志追加。<strong>同时也可以当做心跳使用</strong>。</p><p><strong>InstallSnapshot RPC（安装快照）：</strong> 安装快照的新的 RPC 来发送快照给太落后的跟随者，由Leader发出。</p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE2.png alt></p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE13.png alt></p><h4 id=24-raft算法特性总结>2.4 Raft算法特性总结</h4><table><thead><tr><th>特性</th><th>解释</th></tr></thead><tbody><tr><td>选举安全特性</td><td>对于一个给定的任期号，最多只会有一个领导人被选举出来</td></tr><tr><td>领导人只附加原则</td><td>领导人绝对不会删除或者覆盖自己的日志，只会增加</td></tr><tr><td>日志匹配原则</td><td>如果两个日志在某一相同索引位置日志条目的任期号相同，那么我们就认为这两个日志从头到该索引位置之间的内容完全一致</td></tr><tr><td>领导人完全特性</td><td>如果某个日志条目在某个任期号中已经被提交，那么这个条目必然出现在更大任期号的所有领导人中</td></tr><tr><td>状态机安全特性</td><td>如果某一服务器已将给定索引位置的日志条目应用至其状态机中，则其他任何服务器在该索引位置不会应用不同的日志条目</td></tr></tbody></table><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE3.png alt></p><p><strong>说明：Raft 在任何时候都保证以上的各个特性</strong></p><h4 id=25-安全性说明>2.5 安全性说明</h4><ul><li><h4 id=选举限制><strong>选举限制</strong></h4><ul><li>选举的时候新的Leader拥有所有之前任期中已经提交的日志条目,也就是说如果前任Leader接收到日志请求后发生宕机，当前日志还没来得及通过PRC同步到Follower的情况下，整个Raft集群再次重新发起选举的时候。选举出来的Leader就是之前的Leader。因为之前的Leader包含了已经提交的全部日志条目。</li><li>Raft 通过比较两份日志中最后一条日志条目的索引值和任期号定义谁的日志比较新。如果两份日志最后的条目的任期号不同，那么任期号大的日志更加新。如果两份日志最后的条目任期号相同，那么日志比较长(last index更大)的那个就更加新。</li></ul></li><li><h4 id=提交之前任期内的日志条目>提交之前任期内的日志条目</h4><p>一条已经被存储到大多数节点上的老日志条目，也依然有可能会被未来的领导人覆盖掉。Raft 永远不会通过计算副本数目的方式去提交一个之前任期内的日志条目。只有领导人当前任期里的日志条目通过计算副本数目可以被提交；</p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE8.png alt></p><p>如图的时间序列展示了为什么领导人无法决定对老任期号的日志条目进行提交。在 (a) 中，S1 是领导人，部分的(跟随者)复制了索引位置 2 的日志条目。在 (b) 中，S1 崩溃了，然后 S5 在任期 3 里通过 S3、S4 和自己的选票赢得选举，然后从客户端接收了一条不一样的日志条目放在了索引 2 处。然后到 (c)，S5 又崩溃了；S1 重新启动，选举成功，开始复制日志。在这时，来自任期 2 的那条日志已经被复制到了集群中的大多数机器上，但是还没有被提交。如果 S1 在 (d) 中又崩溃了，S5 可以重新被选举成功（通过来自 S2，S3 和 S4 的选票），然后覆盖了他们在索引 2 处的日志。反之，如果在崩溃之前，S1 把自己主导的新任期里产生的日志条目复制到了大多数机器上，就如 (e) 中那样，那么在后面任期里面这些新的日志条目就会被提交（因为 S5 就不可能选举成功）。 这样在同一时刻就同时保证了，之前的所有老的日志条目就会被提交。</p></li></ul><h3 id=3-raft功能>3. Raft功能</h3><h4 id=31-领导人选举leader-election>3.1 领导人选举（Leader election）</h4><ul><li><p><strong>触发时机：</strong> Raft服务集群启动、Follower没有定时收到Leader heartbeat、Candidate选举超时都会触发。也就是<strong>选举超时</strong>触发</p></li><li><p><strong>随机选举超时时间：</strong> Raft 算法使用随机选举超时时间的方法来确保很少会发生选票瓜分的情况，就算发生也能很快的解决。为了阻止选票起初就被瓜分，选举超时时间是从一个固定的区间（例如 150-300 毫秒）随机选择。</p></li><li><p><strong>选举流程：</strong></p><ul><li>Follower &mdash;> Candidate（选举超时）<ul><li>Candidate&mdash;>Leader：当前节点赢得选举</li><li>Candidate&mdash;>Follower：非赢得选举节点的Candidate节点</li><li>选举Term内Candidate没有改变Candidate&mdash;>Candidate：没有任何一个Candidate节点赢得选举重新开始下一轮任期的选举</li></ul></li></ul><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/%E9%80%89%E4%B8%BE%E6%B5%81%E7%A8%8B.png alt=选举流程></p></li><li><p><strong>选举的操作：</strong></p><ul><li>任期(Term)增加1</li><li>发送RequestVote RPC请求给Candidate</li></ul></li><li><p><strong>Leader选取原则：</strong></p><ul><li>针对同一个Term,Candidate赢得了多数选举(大于节点1/2)</li><li>Leader Term 不小于Candidate Term, Candidate承认Leader,角色转换为Follower</li><li>在选举的时候选择已提交Log Entry最多的Candidate</li><li>在选举中Leader拥有最完整的Log Entry记录</li></ul></li><li><p><strong>安全性：</strong></p><p>一个 term，最多选出一个 leader，可以没 leader，下一个 term 再选</p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/Raft%E9%80%89%E4%B8%BE.png alt=Raft选举></p><p>当一个集群中的节点是偶数个的时候，就有可能在某一轮选举投票过程中不能选举出Leader,因为可能会出现两个节点获得的投票一样。导致重新开始选举。如果没有特殊方式限制，理论上存在每次都出现投票获得情况一样。而奇数节点就能大大减少这种情况。</p></li><li><p>影响选举成功的时参数</p><ul><li>RTT(Round Trip Time)：网络延时</li><li>Heartbeat timeout：心跳间隔,目的是让 leader 能够持续发送心跳来阻止 followers 触发选举</li><li>Election timeout：Leader 与 followers 间通信超时触发选举的时间。Leader和Follower之间网络发生故障</li><li>MTBF(Meantime Between Failure)：Servers 连续常规故障时间间隔， <strong><code>RTT &lt;&lt; Heartbeat timeout &lt; Election timeout(ET) &lt;&lt; MTBF</code></strong></li><li>随机选主触发时间：150-300 毫秒选取。</li></ul></li></ul><h4 id=32-日志复制>3.2 日志复制</h4><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/Log%20replication.png alt></p><p>Leader被选出后负责处理Client的请求， Append Log Entry请求只能通过Leader进行复制转发到Follower。</p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE6.png alt></p><p><strong>日志格式：</strong> <strong><code>logIndex+Term+log body</code></strong> ，条日志至少包含三个类型的的数据。<strong><code>logIndex+Term</code></strong> 确定一条日志。</p><p><strong>Log Replication 特点：</strong></p><ul><li><p>连续性，日志不允许出现断层。都是自然数递增的情况，例如：1、2、3&mldr;&mldr;n。</p></li><li><p>日志特性</p><ul><li>如果在不同的日志中的两个条目拥有相同的索引和任期号，那么他们存储了相同的日志</li><li>如果在不同的日志中的两个条目拥有相同的索引和任期号，那么他们之前的所有日志条目也全部相同</li><li>Leader上面的日志一定是有效的(强领导特性)，Follower的日志是否有效需要和Leader进行对比</li></ul></li><li><p>Follower日志恢复</p><p>Follower从对比Leader的lastIndex来判断Follower是否需要从Leader复制Log填充，或者truncate Follower 多余的日志。</p></li></ul><h4 id=33-committed-index>3.3 Committed Index</h4><ul><li><p>Committed Index<code>(TermId, LogIndex)</code>：本质上Log Index一样。都是Log的索引但是指向位置不同。</p><ul><li>Leader接收日志，先保存到Leader本地持久化。然后复制分发给Follower</li><li>日志复制到Followers后，先持久化，并不能马上应用到状态机</li><li>Leader收到大多数(大于1/2)Follower的返回的时候，Committed Index才能应用到状态机</li></ul></li><li><p>Committed Index推进</p><ul><li>Leader Committed Index推进：根据Leader分发日志Leader收到大多数(大于1/2)Follower的返回的时候，Committed Index才能应用到状态机</li><li>Follower Committed Index推进：Leader在下一个Append Entry或者 send Heartbeat的时候携带Leader当前Committed Index。然后Follower根据Leader 发送过来的Committed Index。把小于等于Committed Index日志应用到Follower状态机中</li></ul></li></ul><h4 id=33-日志压缩log-snapshot>3.3 日志压缩(Log Snapshot)</h4><p>Raft 的日志在正常操作中不断地增长，但是在实际的系统中，日志不能无限制地增长。随着日志不断增长，他会占用越来越多的空间，花费越来越多的时间来重置。如果没有一定的机制去清除日志里积累的陈旧的信息，那么会带来可用性问题。</p><p><strong>Snapshot</strong> 是最简单压缩方法。整个系统的状态都以快照的形式写入到稳定的持久化存储中，然后到那个时间点之前的日志全部丢弃。</p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE12.png alt></p><p>Raft 中快照的基础思想。每个服务器独立地创建快照，只包括已经被提交的日志。主要的工作包括将状态机的状态写入到快照中。Raft 也包含一些少量的元数据到快照中：<strong>最后被包含索引</strong>指的是被快照取代的最后的条目在日志中的索引值（状态机最后应用的日志），<strong>最后被包含的任期</strong>指的是该条目的任期号。保留这些数据是为了支持快照后紧接着的第一个条目的附加日志请求时的一致性检查，因为这个条目需要前一日志条目的索引值和任期号。</p><p>快照中包含的元数据：</p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>lastIncludedIndex</td><td>快照中包含的最后日志条目的索引值</td></tr><tr><td>lastIncludedTerm</td><td>快照中包含的最后日志条目的任期号</td></tr></tbody></table><p><strong>Install Snapshot（安装快照）RPC：</strong></p><p>由Leader以将快照的分块发送给跟随者。领导人总是按顺序发送分块。</p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>term</td><td>领导人的任期号</td></tr><tr><td>leaderId</td><td>领导人的 ID，以便于跟随者重定向请求</td></tr><tr><td>lastIncludedIndex</td><td>快照中包含的最后日志条目的索引值</td></tr><tr><td>lastIncludedTerm</td><td>快照中包含的最后日志条目的任期号</td></tr><tr><td>offset</td><td>分块在快照中的字节偏移量</td></tr><tr><td>data[]</td><td>从偏移量开始的快照分块的原始字节</td></tr><tr><td>done</td><td>如果这是最后一个分块则为 true</td></tr></tbody></table><table><thead><tr><th>结果</th><th>解释</th></tr></thead><tbody><tr><td>term</td><td>当前任期号（currentTerm），便于领导人更新自己</td></tr></tbody></table><p><strong>接收者实现</strong>：</p><ol><li>如果<code>term &lt; currentTerm</code>就立即回复</li><li>如果是第一个分块（offset 为 0）就创建一个新的快照</li><li>在指定偏移量写入数据</li><li>如果 done 是 false，则继续等待更多的数据</li><li>保存快照文件，丢弃具有较小索引的任何现有或部分快照</li><li>如果现存的日志条目与快照中最后包含的日志条目具有相同的索引值和任期号，则保留其后的日志条目并进行回复</li><li>丢弃整个日志</li><li>使用快照重置状态机（并加载快照的集群配置）</li></ol><h3 id=4-raft集群成员变化>4. Raft集群成员变化</h3><ul><li><strong>成员何时变化</strong><ul><li>替换宕机的机器</li><li>增加集群机器(扩容)</li><li>改变复制级别</li></ul></li><li><strong>解决方法</strong><ul><li>重启整个Raft集群</li><li>实现动态成员关系变化</li></ul></li></ul><p>首先任何集群中的Raft服务直接从旧的配置直接转换到新的配置的方案都是不安全的，不可能做到原子转换所有的集群服务。所以在转换期间整个集群存在划分成两个独立的大多数群体的可能性，需要在保证 <strong><code>安全性</code></strong> 的前提下完成：<strong>不能在同一 <code>term</code> 有多个 <code>leader</code>，否则可能存在 <code>term</code> 和 <code>index</code> 相同但内容不同的 <code>log entry</code>。</strong></p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE10.png alt></p><blockquote><p>集群服务从 3变成了 5 。不幸的是，存在这样的一个时间点，两个不同的领导人在同一个任期里都可以被选举成功。一个是通过旧的配置，一个通过新的配置。</p></blockquote><p>Raft给出的解决方案是：Raft集群先切换到一个过度的配置也叫共同一致（<em>joint consensus</em>)，共同一致是新老配置的结合。一旦共同一致已经被提交，那么系统就切换新的配置。</p><ul><li>日志条目被复制给集群中新、老配置的所有服务。</li><li>新、旧配置的服务都可以成为领导人。</li><li>达成一致（针对选举和提交）需要分别在两种配置上获得大多数的支持。</li></ul><p><strong>好处：不影响安全的情况下，集群配置转换的过程依然可以响应客户端请求。</strong></p><p><img src=https://raw.githubusercontent.com/mxsm/picture/main/others/theory/raft-%E5%9B%BE11.png alt></p><h3 id=5-raft的优化>5. Raft的优化</h3><ul><li><strong>Log batch Append：</strong> 日志批量添加，增加Raft的写入速度</li><li><strong>ReadIndex/Lease Read：</strong> 允许Follower提供读</li></ul><p>后续会通过 <a href=https://github.com/openmessaging/dledger>DLedger</a>项目进行分析，这个项目首先比较简单整体实现起来比较清晰。同时代码量也不是很多理解更加容易。</p><blockquote><p>我是蚂蚁背大象，文章对你有帮助点赞关注我，文章有不正确的地方请您斧正留言评论~谢谢</p></blockquote><p>参考资料：</p><ul><li><p><a href=https://raft.github.io/raft.pdf>https://raft.github.io/raft.pdf</a></p></li><li><p><a href=https://github.com/maemual/raft-zh_cn/blob/master/raft-zh_cn.md>https://github.com/maemual/raft-zh_cn/blob/master/raft-zh_cn.md</a></p></li><li><p><a href=https://www.sofastack.tech/projects/sofa-jraft/consistency-raft-jraft/>https://www.sofastack.tech/projects/sofa-jraft/consistency-raft-jraft/</a></p></li><li><p><a href=https://raft.github.io/>https://raft.github.io/</a></p></li><li><p><a href=https://raft.github.io/slides/raftuserstudy2013.p>https://raft.github.io/slides/raftuserstudy2013.p</a></p></li><li><p><a href=https://github.com/openmessaging/dledger>https://github.com/openmessaging/dledger</a></p></li></ul><p>我正在参与掘金技术社区创作者签约计划招募活动，<a href=https://juejin.cn/post/7112770927082864653>点击链接报名投稿</a>。</p><br><div class=page-blank><div id=disqus_thread></div><script>(function(){var a=document,b=a.createElement('script');b.src='https://ljbmxsm.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class="text-muted mt-5 pt-3 border-top">最后修改 2022-07-29: <a href=https://github.com/mxsm/mxsm-website/commit/1cd62d8abbfcba1f1b11f10b00197b1e2945b71d>[ISSUE #6]Add an article about Raft theory (1cd62d8)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=https://groups.google.com/u/1/g/ljbmxsm><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=个人掘金主页 aria-label=个人掘金主页><a class=text-white target=_blank rel="noopener noreferrer" href=https://juejin.cn/user/1151943918492855><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/mxsm><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 The Docsy Authors All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank>隐私政策</a></small><p class=mt-2><a href=/about/>Home</a></p></div></div></div></footer><div><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script><script>$("p img").wrap(function(){return'<a data-fancybox="gallery" href="'+$(this).attr('src')+'"></a>'})</script></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/mermaid@8.8.1/dist/mermaid.min.js integrity=sha384-to2w0I1OqmbJ9J6yTnIX+KYU8grNpZoD1dKPLjgEJvMe5L5+/7qvuNa2sQo8WAWj crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js integrity="sha512-tBzZQxySO5q5lqwLWfu8Q+o4VkTcRGOeQGVQ0ueJga4A1RKuzmAu5HXDOXLEjpbKyV7ow9ympVoa6wZLEzRzDg==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.15.0/flowchart.min.js integrity="sha512-6QsSiIybtf8tuZ6xfjRTr2tdtw3Gp4q5RSCh2b6q9seoKEQmhAG1RrCA8F0kXTwivVxRVbp/YF3zOh8rvEAU7Q==" crossorigin=anonymous></script><script src=/js/main.min.b541b310f01941a0abfd76b652b5fb60dac470573775bb5b31ff08fe3f6cea51.js integrity="sha256-tUGzEPAZQaCr/Xa2UrX7YNrEcFc3dbtbMf8I/j9s6lE=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js></script><script type=text/javascript>docsearch({appId:'JO2SY3WDAC',apiKey:'324ddb3b679c1308e5aa8bf222e07f8b',indexName:'mxsm',inputSelector:'.td-search-input',debug:!1})</script></body></html>